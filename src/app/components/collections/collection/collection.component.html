<div class="app-collection app-h-100">
  <div fxLayout="column" fxFlexFill>
    <div class="app-topbar">
      <div class="app-breadcrumbs app-mb-4">
        <mat-icon class="material-icons-outlined app-mr-2">home</mat-icon>
        <a routerLink="/">home</a>
        <span class="app-separator">/</span>
        <a routerLink="/collections">{{ 'navbar.collections' | translate }}</a>
        <span class="app-separator">/</span>
        <span class="app-last">{{ getCollectionName(collection) }}</span>
      </div>
      <div>
        <nav mat-tab-nav-bar>
          <a mat-tab-link (click)="changeView('detail')" [active]="view == 'detail'">
            <mat-icon class="material-icons-outlined">visibility</mat-icon>{{ 'tabnav.detail' | translate }}
          </a>
          <a mat-tab-link (click)="changeView('edit')" [active]="view == 'edit'">
            <mat-icon class="material-icons-outlined">edit</mat-icon>{{ 'tabnav.edit' | translate }}
          </a>
          <a mat-tab-link (click)="changeView('content')" [active]="view == 'content'">
            <mat-icon class="material-icons-outlined">segment</mat-icon>{{ 'tabnav.content' | translate }}
          </a>
          <a mat-tab-link (click)="changeView('context')" [active]="view == 'context'">
            <mat-icon class="material-icons-outlined">source</mat-icon>{{ 'tabnav.context' | translate }}
          </a>
        </nav>
      </div>
    </div>
    <div fxFlex class="app-oa-y">
      <div class="app-container">
        <mat-card class="app-card app-view-border app-view-header" fxLayout="row" fxLayoutAlign="start center"
          fxLayoutGap="32px">
          <div fxFlex class="app-text-cutter">
            <a (click)="copyTextToClipboard(getCurrentRoute('string'))"
              [matTooltip]="'button.copyTheTextToTheClipboard' | translate">
              <mat-icon class="app-16 app-va-sub app-mr-2">content_copy</mat-icon>
            </a><span class="app-desc">{{ getCurrentRoute('string') }}</span><span class="app-pipe"></span><span
              [matTooltip]="getCollectionDescription(collection)" class="app-desc">{{
              getCollectionDescription(collection) }}</span>
          </div>
          <div *ngIf="view === 'content'">
            <a mat-flat-button color="primary" (click)="onAddItemsToThisCollection()">
              <mat-icon>add_circle</mat-icon>{{ 'button.addToThisCollection' | translate }}
            </a>
          </div>
          <div *ngIf="view === 'context'">
            <a mat-flat-button color="primary" (click)="onAddThisToSuperCollection()">
              <mat-icon>add_circle</mat-icon>{{ 'button.addThisCollectionToAnotherCollection' | translate }}
            </a>
          </div>
        </mat-card>

        <!-- TODO: tohle taky patri do komponenty s obsahem -->
        <mat-card *ngIf="view === 'context'" class="app-card app-view-border">
          <strong>{{ 'desc.collectionsContainingThisCollection' | translate }}:</strong>
        </mat-card>

        <div *ngIf="collection">

          <mat-card fxLayout="column" *ngIf="view == 'detail'"
            class="app-card app-view-border app-maxh-100 app-p-0 app-oa-y">
            <app-collection-detail [collection]="collection" [state]="state"></app-collection-detail>
          </mat-card>

          <mat-card fxLayout="column" *ngIf="view == 'edit'"
            class="app-card app-view-border app-maxh-100 app-p-0 app-oa-y">
            <app-collection-edit (delete)="onDelete()" (updated)="onUpdated()" [colId]="collection.id">
            </app-collection-edit>
          </mat-card>

          <mat-card fxLayout="column" *ngIf="view == 'content' && items"
            class="app-card app-view-border app-maxh-100 app-p-0 app-oa-y">
            <app-collection-content [collection]="collection" [state]="state" [items]="items" (updated)="onUpdated()">
            </app-collection-content>
          </mat-card>

          <!-- TODO: move to own component -->
          <mat-card fxLayout="column" *ngIf="view === 'context' && superCollections"
            class="app-card app-view-border app-maxh-100 app-p-0 app-oa-y">
            <mat-progress-bar mode="indeterminate" *ngIf="state=='loading'"></mat-progress-bar>
            <mat-card class="app-view-rights app-view-hover app-cursor-pointer"
              *ngFor="let superCollection of superCollections" [routerLink]="['/collections', superCollection['id']]">
              <mat-card-header fxLayout="row" fxLayoutGap="16px">
                <div>
                  <img [src]="getThumb(superCollection['id'])" />
                </div>
                <div fxFlex class="app-left">
                  <mat-card-title>
                    <mat-icon>link</mat-icon>{{ getCollectionName(superCollection) }}
                  </mat-card-title>
                  <mat-card-subtitle>{{ getCollectionDescription(superCollection) }}</mat-card-subtitle>
                </div>
                <div class="app-right app-actions">
                  <a (click)="onRemoveItemFromCollection(superCollection['id'], getCollectionName(superCollection), collection.id, getCollectionName(collection)); $event.preventDefault(); $event.stopPropagation()"
                    [matTooltip]="'button.removeFromCollection' | translate" class="app-btn-warn">
                    <mat-icon>cancel</mat-icon>
                  </a>
                </div>
              </mat-card-header>
            </mat-card>
          </mat-card>
        </div>
      </div>
    </div>
  </div>
</div>